<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="~{my_profile :: meta}"></th:block>
    <title>Найти альбомы</title>
    <th:block th:replace="~{my_profile :: style}"></th:block>
</head>
<body>

<th:block th:replace="~{my_profile :: header}"></th:block>

<h1>Найти альбомы</h1>

<form id="findAlbums">
    <label for="word">Введите ключевые слова</label>
    <input type="search" id="word" name="word" required>
    <button>искать</button>
</form>

<script>

    const form = document.getElementById('findAlbums');

    form.addEventListener('submit', function(event) {
        event.preventDefault();

        const word = document.getElementById('word').value;

        fetch(`http://localhost:8765/albums/find_albums/${word}`, requestOptions)
            .then(response => {
                if (response.ok) {
                    return response.json();
                }
                throw new Error('Network response was not ok.');
            })
            .then(data => {
                let body = document.querySelector('body'),
                    p = document.createElement('h1');

                if (Object.keys(data).length === 0) {
                    p.textContent = `По запросу ничего не найдено`;
                    body.appendChild(p);
                } else {
                    let key,
                        a,
                        host = window.location.host;
                    for (key in data) {
                        p = document.createElement('p');
                        a = document.createElement('a');
                        a.href = `http://${host}/album/${data[key].id}`;
                        a.textContent = `${data[key].name}`;
                        p.appendChild(a);
                        body.appendChild(p);
                    }
                }
            })
            .catch(error => {
                console.error('Произошла ошибка:', error);
            });

    });

</script>

</body>
</html>